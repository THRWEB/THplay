<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Solo Classic - THplay</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#111] text-white font-sans">

  <!-- TOP NAVBAR -->
  <div class="flex justify-between items-center px-4 py-3 bg-gray-900 shadow">
    <a href="main.html" class="text-yellow-400 text-2xl font-bold">THplay</a>
    <div class="flex items-center space-x-4">
      <div id="walletDisplay" class="text-yellow-400 font-bold">Wallet: ₹0</div>
      <img id="sidebarPic" src="" alt="Profile" class="w-10 h-10 rounded-full" />
    </div>
  </div>

  <!-- Match Cards Grid -->
  <div class="grid grid-cols-1 gap-4 p-4">
    <!-- Match 1 -->
    <div class="bg-gray-800 rounded-xl p-4 cursor-pointer hover:bg-gray-700" onclick="selectMatch('1')">
      <img src="https://i.postimg.cc/mrBf9X8f/file-00000000ad90622f81015bdfb65ca95f.png" class="w-full rounded mb-2">
      <h2 class="text-xl font-bold">Solo Classic - 5:00 PM</h2>
      <p>Entry Fee: ₹<span id="entryFee1">--</span></p>
      <p>Prize Per Kill: ₹<span id="prizePerKill1">--</span></p>
      <p>Map: <span id="matchMap1">--</span></p>
      <p>Slots: <span id="slotCount1">--</span></p>
    </div>

    <!-- Match 2 -->
    <div class="bg-gray-800 rounded-xl p-4 cursor-pointer hover:bg-gray-700" onclick="selectMatch('2')">
      <img src="https://i.postimg.cc/mrBf9X8f/file-00000000ad90622f81015bdfb65ca95f.png" class="w-full rounded mb-2">
      <h2 class="text-xl font-bold">Coming Soon</h2>
      <p>Entry Fee: ₹<span id="entryFee2">--</span></p>
      <p>Prize Per Kill: ₹<span id="prizePerKill2">--</span></p>
      <p>Map: <span id="matchMap2">--</span></p>
      <p>Slots: <span id="slotCount2">--</span></p>
    </div>

    <!-- Match 3 -->
    <div class="bg-gray-800 rounded-xl p-4 cursor-pointer hover:bg-gray-700" onclick="selectMatch('3')">
      <img src="https://i.postimg.cc/mrBf9X8f/file-00000000ad90622f81015bdfb65ca95f.png" class="w-full rounded mb-2">
      <h2 class="text-xl font-bold">Coming Soon</h2>
      <p>Entry Fee: ₹<span id="entryFee3">--</span></p>
      <p>Prize Per Kill: ₹<span id="prizePerKill3">--</span></p>
      <p>Map: <span id="matchMap3">--</span></p>
      <p>Slots: <span id="slotCount3">--</span></p>
    </div>
  </div>

  <!-- Firebase Script -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBcLtCEmRCkUTwO0TaMk4piYiIHcZfjJjk",
      authDomain: "thplay-b3c68.firebaseapp.com",
      projectId: "thplay-b3c68",
      storageBucket: "thplay-b3c68.appspot.com",
      messagingSenderId: "243301774162",
      appId: "1:243301774162:web:be1d08fd88dd3edb90008b"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const db = getFirestore();
    const matchData = {};

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        document.getElementById("sidebarPic").src = user.photoURL || "";

        // Show wallet balance
        const userRef = doc(db, "users", user.uid);
        onSnapshot(userRef, (docSnap) => {
          if (docSnap.exists()) {
            const wallet = docSnap.data().wallet || 0;
            document.getElementById("walletDisplay").textContent = `Wallet: ₹${wallet}`;
          }
        });

        // Load match info
        const loadMatch = async (matchId, suffix) => {
          const matchDoc = await getDoc(doc(db, "matches", matchId));
          if (matchDoc.exists()) {
            const data = matchDoc.data();
            document.getElementById(`entryFee${suffix}`).textContent = data.entryfees || "--";
            document.getElementById(`prizePerKill${suffix}`).textContent = data.prizeperkill || "--";
            document.getElementById(`matchMap${suffix}`).textContent = data.map || "--";
            document.getElementById(`slotCount${suffix}`).textContent = `${data.slot || 0}/${data.maxslots || 48}`;

            matchData[`match${suffix}`] = {
              matchId,
              entryFee: data.entryfees || "--",
              prize: data.prizeperkill || "--",
              map: data.map || "--",
              slot: `${data.slot || 0}/${data.maxslots || 48}`,
              image: "https://i.postimg.cc/mrBf9X8f/file-00000000ad90622f81015bdfb65ca95f.png",
              time: data.time || "--",
              date: data.date || "--"
            };
          }
        };

        await loadMatch("match1", "1");
        await loadMatch("match2", "2");
        await loadMatch("match3", "3");

        window.selectMatch = function(suffix) {
          const selected = matchData[`match${suffix}`];
          if (selected) {
            localStorage.setItem("selectedMatch", JSON.stringify(selected));
            window.location.href = "joinsolo.html";
          }
        };
      } else {
        window.location.href = "index.html"; // redirect to login
      }
    });
  </script>
</body>
</html>
